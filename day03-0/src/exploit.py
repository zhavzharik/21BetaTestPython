from bs4 import BeautifulSoup

"""
Exercise 00: Innocent Prank

First, it needs to read a file "evilcorp.html"
"""
path = "/Users/abridger/Python_day03-0/evilcorp.html"
with open(path) as fp:
    soup = BeautifulSoup(fp, 'html.parser')

"""
Second modify page title (in <title> tags) to be "Evil Corp - Stealing your money every day"
"""
soup.title.string.replace_with("Evil Corp - Stealing your money every day")

"""
Third, it should parse out the name of the user from the page (including the pronoun) and inject new tag <h1>
into a body of a page, saying <h1>Mr. Robot, you are hacked!</h1>, where 'Mr. Robot' is a parsed pronoun
and name.
"""
original_tag = soup.body
new_tag = soup.new_tag("h1")
new_text = soup.span.span.contents[0] + list(soup.span.children)[1] + ", you are hacked!"
new_tag.insert(1, new_text)
original_tag.append(new_tag)

"""
Fourth, it needs to inject a Trenton's script into a body of a page as well. If everything is okay, when
the 'Send' button is pressed, you should see the word "hacked" appearing in an alert window.
"""
trenton_tag = soup.new_tag("script")
trenton_script = """
        hacked = function() {
            alert('hacked');
        }
        window.addEventListener('load', 
          function() { 
            var f = document.querySelector("form");
            f.setAttribute("onsubmit", "hacked()");
          },
          false
        );
"""
trenton_tag.insert(1, trenton_script)
original_tag.append(trenton_tag)

"""
Finally, the link at the bottom of a page should now lead to "https://mrrobot.fandom.com/wiki/Fsociety" with
an actual name of the company on a page replaced with "Fsociety".
"""
new_url = "https://mrrobot.fandom.com/wiki/Fsociety"
soup.a['href'] = new_url

"""
The new HTML file should be named "evilcorp_hacked.html" and placed in the same directory as the source
"evilcorp.html" file.
"""
new_file = soup.prettify()
with open("/Users/abridger/Python_day03-0/evilcorp_hacked.html", "w") as file:
    file.write(str(new_file))

# you can just run
# python3 -m http.server
# in a directory with this file to be able to test exercise
# http://127.0.0.1:8000/evilcorp.html
# http://127.0.0.1:8000/evilcorp_hacked.html
